# Function to add Zsh completions
function zsh_add_completion() {
    local plugin_name=$(echo $1 | cut -d "/" -f 2)
    local plugin_path="$ZDOTDIR/plugins/$plugin_name"

    if [ -d "$plugin_path" ]; then 
        # For completions
        local completion_file_path=$(ls "$plugin_path"/_*)
        fpath+="$(dirname "${completion_file_path}")"
        zsh_add_file "plugins/$plugin_name/$plugin_name.plugin.zsh"
    else
        git clone "https://github.com/$1.git" "$plugin_path"
        fpath+=$(ls "$plugin_path"/_*)
        rm "$ZDOTDIR/.zccompdump"
    fi
    
    local completion_file="$(basename "${completion_file_path}")"
    if [ "$2" = true ] && compinit "${completion_file:1}"
}

# Function to add Zsh plugins
function zsh_add_plugin() {
    local plugin_name=$(echo $1 | cut -d "/" -f 2)
    local plugin_path="$ZDOTDIR/plugins/$plugin_name"

    if [ -d "$plugin_path" ]; then 
        # For plugins
        zsh_add_file "plugins/$plugin_name/$plugin_name.plugin.zsh" || \
        zsh_add_file "plugins/$plugin_name/$plugin_name.zsh"
    else
        git clone "https://github.com/$1.git" "$plugin_path"
    fi
}

# Function to source files if they exist
function zsh_add_file() {
    local file_path="$ZDOTDIR/$1"
    [ -f "$file_path" ] && source "$file_path"
}
